<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-12-13" />

<title>Tidy bootstrapping</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tidy bootstrapping</h1>
<h4 class="date">2019-12-13</h4>



<div id="tidy-bootstrapping" class="section level1">
<h1>Tidy bootstrapping</h1>
<p>Another place where combining model fits in a tidy way becomes useful is when performing bootstrapping or permutation tests. These approaches have been explored before, for instance by <a href="http://rstudio-pubs-static.s3.amazonaws.com/19698_a4c472606e3c43e4b94720506e49bb7b.html">Andrew MacDonald here</a>, and <a href="https://github.com/hadley/dplyr/issues/269">Hadley has explored efficient support for bootstrapping</a> as a potential enhancement to dplyr. broom fits naturally with dplyr in performing these analyses.</p>
<p>Bootstrapping consists of randomly sampling a dataset with replacement, then performing the analysis individually on each bootstrapped replicate. The variation in the resulting estimate is then a reasonable approximation of the variance in our estimate.</p>
<p>Let’s say we want to fit a nonlinear model to the weight/mileage relationship in the <code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(mpg, wt)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We might use the method of nonlinear least squares (via the <code>nls</code> function) to fit a model.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">nlsfit &lt;-<span class="st"> </span><span class="kw">nls</span>(mpg <span class="op">~</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>b, mtcars, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">summary</span>(nlsfit)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; Formula: mpg ~ k/wt + b</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; Parameters:</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;   Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; k   45.829      4.249  10.786 7.64e-12 ***</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; b    4.386      1.536   2.855  0.00774 ** </span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; Residual standard error: 2.774 on 30 degrees of freedom</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; Number of iterations to convergence: 1 </span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; Achieved convergence tolerance: 2.877e-08</span></a>
<a class="sourceLine" id="cb2-17" title="17"></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">predict</span>(nlsfit)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>While this does provide a p-value and confidence intervals for the parameters, these are based on model assumptions that may not hold in real data. Bootstrapping is a popular method for providing confidence intervals and predictions that are more robust to the nature of the data.</p>
<p>We can use the <code>bootstraps</code> function in the <strong>rsample</strong> package to sample bootstrap replications. First, we construct 100 bootstrap replications of the data, each of which has been randomly sampled with replacement. The resulting object is an <code>rset</code>, which is a dataframe with a column of <code>rsplit</code> objects.</p>
<p>An <code>rsplit</code> object has two main components: an analysis dataset and an assessment dataset, accessible via <code>analysis(rsplit)</code> and <code>assessment(rsplit)</code> respectively. For bootstrap samples, the analysis dataset is the bootstrap sample itself, and the assessment dataset consists of all the out of bag samples.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(rsample)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw">set.seed</span>(<span class="dv">27</span>)</a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8">boots &lt;-<span class="st"> </span><span class="kw">bootstraps</span>(mtcars, <span class="dt">times =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb3-9" title="9">boots</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; # Bootstrap sampling </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; # A tibble: 100 x 2</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;    splits          id          </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;    &lt;list&gt;          &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;  1 &lt;split [32/13]&gt; Bootstrap001</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;  2 &lt;split [32/10]&gt; Bootstrap002</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;  3 &lt;split [32/13]&gt; Bootstrap003</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;  4 &lt;split [32/11]&gt; Bootstrap004</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt;  5 &lt;split [32/9]&gt;  Bootstrap005</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt;  6 &lt;split [32/10]&gt; Bootstrap006</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt;  7 &lt;split [32/11]&gt; Bootstrap007</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt;  8 &lt;split [32/13]&gt; Bootstrap008</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt;  9 &lt;split [32/11]&gt; Bootstrap009</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; 10 &lt;split [32/11]&gt; Bootstrap010</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt; # … with 90 more rows</span></a></code></pre></div>
<p>We create a helper function to fit an <code>nls</code> model on each bootstrap sample, and then use <code>purrr::map</code> to apply this function to all the bootstrap samples at once. Similarly, we create a column of tidy coefficient information by unnesting.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">fit_nls_on_bootstrap &lt;-<span class="st"> </span><span class="cf">function</span>(split) {</a>
<a class="sourceLine" id="cb4-2" title="2">    <span class="kw">nls</span>(mpg <span class="op">~</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>b, <span class="kw">analysis</span>(split), <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb4-3" title="3">}</a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5">boot_models &lt;-<span class="st"> </span>boots <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">map</span>(splits, fit_nls_on_bootstrap),</a>
<a class="sourceLine" id="cb4-7" title="7">           <span class="dt">coef_info =</span> <span class="kw">map</span>(model, tidy))</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">boot_coefs &lt;-<span class="st"> </span>boot_models <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">    </span><span class="kw">unnest</span>(coef_info)</a></code></pre></div>
<p>The unnested coefficient information contains a summary of each replication combined in a single data frame:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">boot_coefs</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; # A tibble: 200 x 8</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt;    splits         id           model term  estimate std.error statistic  p.value</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt;    &lt;list&gt;         &lt;chr&gt;        &lt;lis&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt;  1 &lt;split [32/13… Bootstrap001 &lt;nls&gt; k        42.1       4.05     10.4  1.91e-11</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;  2 &lt;split [32/13… Bootstrap001 &lt;nls&gt; b         5.39      1.43      3.78 6.93e- 4</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;  3 &lt;split [32/10… Bootstrap002 &lt;nls&gt; k        49.9       5.66      8.82 7.82e-10</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt;  4 &lt;split [32/10… Bootstrap002 &lt;nls&gt; b         3.73      1.92      1.94 6.13e- 2</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;  5 &lt;split [32/13… Bootstrap003 &lt;nls&gt; k        37.8       2.68     14.1  9.01e-15</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;  6 &lt;split [32/13… Bootstrap003 &lt;nls&gt; b         6.73      1.17      5.75 2.78e- 6</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;  7 &lt;split [32/11… Bootstrap004 &lt;nls&gt; k        45.6       4.45     10.2  2.70e-11</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt;  8 &lt;split [32/11… Bootstrap004 &lt;nls&gt; b         4.75      1.62      2.93 6.38e- 3</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt;  9 &lt;split [32/9]&gt; Bootstrap005 &lt;nls&gt; k        43.6       4.63      9.41 1.85e-10</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; 10 &lt;split [32/9]&gt; Bootstrap005 &lt;nls&gt; b         5.89      1.68      3.51 1.44e- 3</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; # … with 190 more rows</span></a></code></pre></div>
<p>We can then calculate confidence intervals (using what is called the <a href="https://www.uvm.edu/~dhowell/StatPages/Randomization%20Tests/ResamplingWithR/BootstMeans/bootstrapping_means.html">percentile method</a>):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb6-2" title="2">boot_coefs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">    </span><span class="kw">group_by</span>(term) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">low =</span> <span class="kw">quantile</span>(estimate, alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb6-5" title="5">              <span class="dt">high =</span> <span class="kw">quantile</span>(estimate, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;   term     low  high</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; 1 b      0.283  6.74</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; 2 k     38.5   57.6</span></a></code></pre></div>
<p>Or we can use histograms to get a more detailed idea of the uncertainty in each estimate:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">ggplot</span>(boot_coefs, <span class="kw">aes</span>(estimate)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>term, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or we can use <code>augment</code> to visualize the uncertainty in the curve:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">boot_aug &lt;-<span class="st"> </span>boot_models <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">augmented =</span> <span class="kw">map</span>(model, augment)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">    </span><span class="kw">unnest</span>(augmented)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5">boot_aug</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; # A tibble: 3,200 x 8</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt;    splits          id           model coef_info         mpg    wt .fitted .resid</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt;    &lt;list&gt;          &lt;chr&gt;        &lt;lis&gt; &lt;list&gt;          &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt;  1 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  18.7  3.44    17.6  1.08 </span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt;  2 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  32.4  2.2     24.5  7.89 </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt;  3 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  15.5  3.52    17.3 -1.84 </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt;  4 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  22.8  3.15    18.7  4.05 </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt;  5 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  24.4  3.19    18.6  5.82 </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt;  6 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  30.4  1.62    31.4 -1.04 </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt;  7 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  10.4  5.42    13.1 -2.75 </span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt;  8 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  21    2.62    21.4 -0.448</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt;  9 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  19.2  3.84    16.3  2.87 </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; 10 &lt;split [32/13]&gt; Bootstrap001 &lt;nls&gt; &lt;tibble [2 × 5…  21    2.62    21.4 -0.448</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; # … with 3,190 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">ggplot</span>(boot_aug, <span class="kw">aes</span>(wt, mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">group =</span> id), <span class="dt">alpha=</span>.<span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With only a few small changes, we could easily perform bootstrapping with other kinds of predictive or hypothesis testing models, since the <code>tidy</code> and <code>augment</code> functions works for many statistical outputs. As another example, we could use <code>smooth.spline</code>, which fits a cubic smoothing spline to data:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">fit_spline_on_bootstrap &lt;-<span class="st"> </span><span class="cf">function</span>(split) {</a>
<a class="sourceLine" id="cb10-2" title="2">    data &lt;-<span class="st"> </span><span class="kw">analysis</span>(split)</a>
<a class="sourceLine" id="cb10-3" title="3">    <span class="kw">smooth.spline</span>(data<span class="op">$</span>wt, data<span class="op">$</span>mpg, <span class="dt">df =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb10-4" title="4">}</a>
<a class="sourceLine" id="cb10-5" title="5"></a>
<a class="sourceLine" id="cb10-6" title="6">boot_splines &lt;-<span class="st"> </span>boots <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">spline =</span> <span class="kw">map</span>(splits, fit_spline_on_bootstrap),</a>
<a class="sourceLine" id="cb10-8" title="8">           <span class="dt">aug_train =</span> <span class="kw">map</span>(spline, augment))</a>
<a class="sourceLine" id="cb10-9" title="9"></a>
<a class="sourceLine" id="cb10-10" title="10">splines_aug &lt;-<span class="st"> </span>boot_splines <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="st">    </span><span class="kw">unnest</span>(aug_train)</a>
<a class="sourceLine" id="cb10-12" title="12"></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="kw">ggplot</span>(splines_aug, <span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">group =</span> id), <span class="dt">alpha =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
