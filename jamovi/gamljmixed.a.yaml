---
name: gamljMixed
title: Mixed Model
menuGroup: Linear Models
version: '3.0.0'
jas: '1.2'
completeWhenFilled: true
export: false
description:
    main: |
          Mixed Linear Model
    R:
        dontrun: false
        usage: |
              data(subjects_by_stimuli)
              gamlj::gamljMixed(
                     formula = y ~ 1 + cond+( 1|subj ),
                     data = subjects_by_stimuli)


options:
    - name: data
      type: Data
      description:
          R: the data as a data frame

    - name: .caller
      type: String
      default: "lmer"
      hidden: true

    - name: .interface
      type: String
      default: "jamovi"
      hidden: true

    - name: dep
      title: Dependent Variable
      type: Variable
      default:
      suggested:
        - continuous
        - ordinal
      permitted:
        - numeric
      description:
          R: >
            a string naming the dependent variable from `data`; the variable
            must be numeric. Not needed if `formula` is used.

    - name: factors
      title: Factors
      type: Variables
      suggested:
         - nominal
      permitted:
        - factor
      default:
      description:
          R: a vector of strings naming the fixed factors from `data`. Not needed if `formula` is used.

    - name: covs
      title: Covariates
      type: Variables
      suggested:
        - continuous
        - ordinal
      permitted:
        - numeric
      default:
      description:
          R: a vector of strings naming the covariates from `data`. Not needed if `formula` is used.


    - name: model_terms
      title: Model Terms
      type: Terms
      default:
      description:
          R: >
            a list of character vectors describing fixed effects terms. Not needed if `formula` is used.

    - name: fixed_intercept
      title: Fixed Intercept
      type: Bool
      default: true
      description:
          R: >
            `TRUE` (default) or `FALSE`, estimates fixed intercept. Not needed if `formula` is used.

    - name: nested_terms
      title: Nested Model
      type: Terms
      default:
      description:
          R: >
            a list of character vectors describing effects terms for nestet. It can be passed as right-hand formula.

    - name: comparison
      title: Activate
      type: Bool
      default: false
      description:
          R: >
             Not present in R


    - name: nested_intercept
      title: Nested Intercept
      type: Bool
      default: true
      description:
          R: >
            `TRUE` (default) or `FALSE`, estimates fixed intercept. Not needed if `formula` is used.

    - name: omnibus
      title: Test
      type: List
      hidden: true
      default: LRT
      options:
        - name: LRT
          title: LRT

      description:
          R: >
            `TRUE` (default) or `FALSE`, estimates fixed intercept. Not needed if `formula` is used.



    - name: estimates_ci
      title: Coefficients
      type: Bool
      default: true
      description:
          R: >
            `TRUE` (default) or `FALSE` , parameters CI in table

    - name: donotrun
      title: Do not run
      type: Bool
      default: false


    - name: ci_method
      title: CI Method
      type: List
      default: wald
      options:
        - name:  wald
          title: Standard (fast)
        - name: quantile
          title: Bootstrap (Percent)
        - name:  bcai
          title: Bootstrap (BCa)
          
    - name: boot_r
      title: Bootstrap rep.
      type: Number
      min: 1
      default: 1000
      description:
          R: >
            a number bootstrap repetitions.

    - name: ci_width
      title: Confidence level
      type: Number
      min: 50
      max: 99.9
      default: 95
      description:
          R: >
            a number between 50 and 99.9 (default: 95) specifying the confidence
            interval width for the plots.




    - name: contrasts
      title: Factors Coding
      type: Array
      items: (factors)
      default: 
      template:
          type: Group
          elements:
              - name: var
                type: Variable
                content: $key
              - name: type
                type: List
                options:
                  - simple
                  - deviation
                  - dummy
                  - difference
                  - helmert
                  - repeated
                  - polynomial

                default: simple
      description:
          R: >
            a named vector of the form `c(var1="type", var2="type2")` specifying the type of contrast to use,
            one of `'deviation'`, `'simple'`, `'dummy'`, `'difference'`, `'helmert'`,
            `'repeated'` or `'polynomial'`. If NULL, `simple` is used. Can also be passed as a list of list of the form list(list(var="var1",type="type1")).


    - name: show_contrastnames
      title: Names in estimates table
      type: Bool
      default: true
      description:
          R: >
            `TRUE` or `FALSE` (default), shows raw names of the contrasts variables in tables


    - name: show_contrastcodes
      title: Contrast Coefficients tables
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), shows contrast coefficients tables


### PLOT

    - name: plot_x
      title: Horizontal axis
      type: Variable
      default:
      description:
          R: >
            a string naming the variable placed on the horizontal axis of the
            plot

    - name: plot_z
      title: Separate lines
      type: Variable
      default:
      description:
          R: >
            a string naming the variable represented as separate lines in the
            plot

    - name: plot_by
      title: Separate plots
      type: Variables
      default:
      
      description:
          R: >
            a list of string naming the variables defining the levels for multiple plots

    - name: plot_raw
      title: Observed scores
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), plot raw data along the predicted values

    - name: plot_yscale
      title: Y-axis observed range 
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), set the Y-axis range equal to the range of the observed values.

    - name: plot_xoriginal
      title: Original scale 
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), use original scale for covariates.

    - name: plot_black
      title: Varying line types 
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), use different linetypes per levels.

    - name: plot_around
      title: Error Bar Definition
      type: List
      options:
        - name: 'none'
          title: None
        - name: ci
          title: Confidence intervals
        - name: se
          title: Standard Error
      default: 'none'
      description:
          R: >
            `'none'` (default), `'ci'`, or `'se'`. Use no error
            bars, use confidence intervals, or use standard errors on the
            plots, respectively.

    - name: plot_re
      title: Random effects
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), add predicted values based on random effect in plot 
    - name: plot_re_method
      type: List
      default: average
      options:
        - name:  average
          title: Average method
        - name:  full
          title: Full predicted method

###

    - name: emmeans
      title: Estimated Marginal Means
      type: Terms
      default:
      description:
          R: a rhs formula with the terms specifying the marginal means to estimate (of the form `'~x+x:z'`)


    - name: posthoc
      title: Post Hoc Tests
      type: Terms
      default:
      description:
          R: >
             a rhs formula with the terms specifying the table to apply the comparisons (of the form `'~x+x:z'`).
             The formula is not expanded, so '`x*z`' becomes '`x+z' and not '`x+z+x:z`'. It can be passed
             also as a list of the form '`list("x","z",c("x","z")`'


    - name: simple_effects
      title: Simple effects variable
      type: Variable
      default:
      description:
          R: >
            The variable for which the simple effects (slopes) are computed

    - name: simple_moderators
      title: Moderators
      type: Variables
      default:
      description:
          R: >
            the variable that provides the levels at which the simple effects are computed

    - name: simple_interactions
      title: Simple Interactions
      type: Bool
      default: false
      description:
          R: >
            should simple Interactions be computed

    - name: covs_conditioning
      title: Covariates Conditioning
      type: List
      options:
        - name: mean_sd
          title: Mean ±  SD
        - name: percent
          title: Percentiles 50 ± offset 
      default: mean_sd
      description:
          R: >
            `'mean_sd'` (default), `'custom'` , or `'percent'`. Use to condition the
            covariates (if any)


    - name: ccm_value
      type: Number
      default: 1
      description:
          R: >
            Covariates conditioning mean offset value: how many st.deviations around the means used to condition simple effects and plots.
            Used if `covs_conditioning`=`'mean_sd'`

    - name: ccp_value
      type: Number
      default: 25
      min: 5
      max: 50
      description:
          R: >
            Covariates conditioning percentile offset value: number of percentiles around the median used to condition simple effects and plots.
            Used if `covs_conditioning`=`'percent'`

    - name: covs_scale_labels
      type: List
      options:
        - name: labels
          title: Labels
        - name: values
          title: Values
        - name: values_labels
          title: Values + Labels
        - name:  uvalues
          title: Unscaled Values
        - name: uvalues_labels
          title: Unscaled Values + Labels

      default: labels
      description:
          R: >
            how the levels of a continuous moderator should appear in tables and plots: `labels`,
            `values` and `values_labels`, `ovalues`, `ovalues_labels. The latter two refer to the
            variable orginal levels, before scaling.




    - name: adjust
      title: Correction
      type: NMXList
      options:
          - name: none
            title: No correction (LSD)
          - name: bonf
            title: Bonferroni
          - name: tukey
            title: Tukey 
          - name: holm
            title: Holm
          - name: scheffe
            title: Scheffe
          - name: sidak
            title: Sidak
      default:
          - bonf
      description:
          R: >
            one or more of `'none'`,  `'bonf'`,`'tukey'` 
            `'holm'`,`'scheffe'`, `'tukey'`; provide no,  Bonferroni, Tukey and
            Holm Post Hoc corrections respectively.


    - name: predicted
      title: Predicted
      type: Output            

    - name: residuals
      title: Residuals
      type: Output            


############ generic with some specs ###########

    - name: model_type
      type: List
      hidden: true
      options:
        - name: lmer
      default: lmer

    - name: covs_scale
      title: Covariates Scaling
      type: Array
      items: (covs)
      default:
      template:
          type: Group
          elements:
              - name: var
                type: Variable
                content: $key
              - name: type
                type: List
                options:
                    - title: Centered
                      name:  centered
                    - title: z-scores
                      name: standardized
                    - title: Centered clusterwise
                      name:  clusterbasedcentered
                    - title: Clusters means
                      name:  clustermeans
                    - title: z-scores clusterwise
                      name:  clusterbasedstandardized
                    - title: None
                      name: 'none'
                default: centered 
      description:
          R: >
            a list of lists specifying the covariates scaling,
            one of `'centered to the mean'`, `'standardized'`, or `'none'`. `'none'` leaves the variable as it is

      
    - name: dep_scale
      title: Scale
      type: List
      options:
                    - title: Original
                      name: 'none'
                    - title: Centered
                      name:  centered
                    - title: z-scores
                      name: standardized
                    - title: Centered clusterwise
                      name:  clusterbasedcentered
                    - title: Clusters means
                      name:  clustermeans
                    - title: z-scores clusterwise
                      name:  clusterbasedstandardized
      default: 'none'
      description:
         R: >
           Re-scale the dependent variable.




#!#!# #### specs here #####


    - name: scale_missing
      title: Scale on 
      type: List
      options:
          - title: Complete cases
            name: 'complete'
          - title: Columnwise 
            name: colwise
      default: 'complete'


    - name: norm_test
      title: Normality of residuals
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), provide a test for normality of residuals


    - name: cluster
      title: Cluster variables
      type: Variables
      default:  
      suggested:
        - nominal
      description:
          R: a vector of strings naming the clustering variables from `data` 

    - name: re
      title: Random Coefficients
      type: Array
      default: [[]]
      template:
          type: Terms
      description:
          R: >
            a list of lists specifying the models random effects.          

    - name: nested_re
      title: Nested Model Random Coefficients
      type: Array
      default: [[]]
      template:
          type: Terms
      description:
          R: >
            a list of lists specifying the models random effects.          

    - name: re_corr
      title: Effects correlation
      type: List
      options:
        - name: all
          title: Correlated
        - name: none
          title: Not correlated
        - name: block
          title: Correlated by block
      default: all
      description:
          R: >
            `'all'`, `'none'` (default), or `'block'`. When random effects
            are passed as list of length 1, it decides whether the effects should be correlated, 
            non correlated. If `'re'` is a list of 
            lists of length > 1, the option is automatially set to `'block'`.
            The option is ignored if the model is passed using `formula`.


    - name: re_modelterms
      title: Model terms
      type: Bool
      default: true
      description:
          R: >
            Not in R interface
            
            
    - name: re_listing
      type: List
      title: "Add"
      options:
        - name:  none
          title: None
        - name:  main
          title: Main effects
        - name:  way2
          title: Up to 2-way
        - name:  way3
          title: Up to 3-way
        - name:  all
          title: All possible
      default: none
      description:
          R: >
             Not in R interface



    - name: reml
      title: REML
      type: Bool
      default: true
      description:
          R: >
            `TRUE` (default) or `FALSE`, should the Restricted ML be used rather than ML

    - name: re_lrt
      title: LRT for Random Effects
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), LRT for the random effects

    - name: re_ci
      title: Random Effect C.I. (slow)
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), confidence intervals for the random effects

####### options ########
    - name: df_method
      title: DF Method
      type: List
      default: Satterthwaite
      options:
        - name: Satterthwaite
          title: Satterthwaite
        - name:  Kenward-Roger
          title: "Kenward-Roger  (slow)"
      description:
          R: >
              The method for computing the denominator degrees of freedom and F-statistics.
              "Satterthwaite" (default) uses Satterthwaite’s method; "Kenward-Roger"
              uses Kenward-Roger’s method, "lme4" returns the lme4-anova table, i.e.,
              using the anova method for lmerMod objects as defined in the lme4-package
              
    - name: norm_plot
      title: Histogram of residuals
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), provide a histogram of residuals superimposed by a normal distribution

    - name: qq_plot
      title: Q-Q plot of residuals
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), provide a Q-Q plot of residuals



    - name: resid_plot
      title: Residuals-Predicted scatterplot
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), provide a scatterplot of the residuals against predicted

    - name: cluster_boxplot
      title: Residuals by cluster boxplot
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), provide a boxplot of random effects by the first defined clustering variable

    - name: cluster_respred
      title: Residuals vs Predicted  
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), residuals vs predicted by the first defined clustering variable

    - name: rand_hist
      title: Histogram of random Coefficients
      type: Bool
      default: false
      description:
          R: >
            `TRUE` or `FALSE` (default), provide histogram of random Coefficients






...

